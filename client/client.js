!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);let i=exports["np-config"].GetModuleConfig("main");const r=new Map;GetCurrentResourceName();async function o(e){return new Promise(t=>setTimeout(()=>t(),e))}on("np-config:configLoaded",(e,t)=>{"main"===e?i=t:r.has(e)&&r.set(e,t)});let a=null;function s(e,t,n=!1){return new Promise(i=>{t?exports["np-taskbar"].taskbar(e,t,n,!0,null,!1,i):setTimeout(()=>i(100),e)})}let l=!1;const c=e=>{l=e,emit("np-drifting:toggleDriftMode",l),emit("DoLongHudText",`Drift Mode ${l?"activated":"disabled"}`)},d=["driftanglekit","driftcoilovers","driftdiff","drifttires","drifthandbrake"];on("baseevents:enteredVehicle",(e,t)=>{if(-1!==t)return;const n=exports["np-vehicles"].GetVehicleAfterMarket(e);if(p(n)===d.length)return console.log("drift mode ready"),emit("np-ui:loadDriftMode",e);console.log("neh eh"),u(e)}),on("baseevents:leftVehicle",()=>{emit("np-drifting:showDriftMode",!1),c(!1)}),onNet("vehicle:swapSeat",e=>{if(-1!==e)return emit("np-drifting:showDriftMode",!1),void c(!1);const t=GetVehiclePedIsIn(PlayerPedId(),!1);u(t)});const u=e=>{if(f(e))return emit("np-drifting:showDriftMode",!1)},f=e=>{const t=exports["np-vehicles"].GetVehicleAfterMarket(e);return p(t)===d.length};on("np-inventory:itemUsed",async e=>{if(!d.includes(e))return;const t=GetEntityCoords(PlayerPedId(),!0),n=GetClosestVehicle(t[0],t[1],t[2],3,0,70);if(console.log(n),!n||!DoesEntityExist(n))return emit("DoLongHudText","No vehicle nearby",2);if(GetVehicleHandlingFloat(n,"CHandlingData","fDriveBiasFront")>.6)return emit("DoLongHudText","Front wheel cars do not accept these parts.",2);const i=exports["np-vehicles"].GetVehicleIdentifier(n);if(!i)return emit("DoLongHudText","You cannot install the mods on this vehicle",2);const[r]=await RPC.execute("IsEmployedAtBusiness",{character:{id:exports.isPed.isPed("cid")},business:{id:"hayes_autos"},distCheck:!0,coords:{x:t[0],y:t[1],z:t[2]}});if(!r)return emit("DoLongHudText","You are not able to apply this part",2);const o=exports["np-vehicles"].GetVehicleAfterMarket(n);if(o&&o[e])return emit("DoLongHudText","This vehicle already has this part",2);var a;await(a="mini@repair",new Promise(e=>{RequestAnimDict(a);const t=setInterval(()=>{HasAnimDictLoaded(a)&&(clearInterval(t),e(!0))},200);setTimeout(()=>{clearInterval(t),e(!1)},5e3)})),TaskPlayAnim(PlayerPedId(),"mini@repair","fixing_a_ped",8,-8,-1,1,1,!1,!1,!1);const l=await s(3e4,"Installing part...");if(ClearPedTasks(PlayerPedId()),100!==l)return;await RPC.execute("np-drifting:parts:apply",i,e);const c=p(o);return emit("inventory:removeItem",e,1),c+1==d.length?emit("DoLongHudText","Part installed! Time to drift!"):emit("DoLongHudText",`part installed! ${d.length-c+1} parts remaining`)});const p=e=>{let t=0;for(const n of d)e&&e[n]&&t++;return t};let h=0,m=null,y=null,g=1e3,v={lastDrift:0,bonus:1,points:0,drfits:0};const P=()=>{clearTick(m),clearTick(null),exports["np-ui"].sendAppEvent("status-hud",{show:!1})},b=()=>{y=GetVehiclePedIsIn(PlayerPedId(),!1),g=GetEntityHealth(y),m&&clearTick(m),m=setTick(async()=>{const[e,t]=x();h+=e,t>20||v.lastDrift>0&&GetGameTimer()>v.lastDrift+1e4?v={lastDrift:0,bonus:1,points:0,drfits:0}:e>0&&(0===v.lastDrift||GetGameTimer()>v.lastDrift+5e3)&&(v.lastDrift=GetGameTimer(),v.points=Math.floor(v.points+e*v.bonus),h=v.points,v.drfits++,v.drfits>=2&&(v.drfits=0,v.bonus=parseFloat((v.bonus+.1).toFixed(2)))),(()=>{let e=`Points: ${Math.ceil(h)}`,t=0;v.bonus>1&&(e+=` (+${v.points})`,t=Math.ceil(100*(v.bonus-1))),exports["np-ui"].sendAppEvent("status-hud",{show:!0,title:"Drift Trails",values:["Position: 1/1",e,`Current Bonus: ${t}%`]})})(),await o(150)})},x=()=>{const e=GetEntitySpeed(y),t=GetVehicleCurrentGear(y),n=GetEntityVelocity(y),i=Math.max(0,g-GetEntityHealth(y));g=GetEntityHealth(y);const r=Math.sqrt(n[0]*n[0]+n[1]*n[1]),o=GetEntityRotation(y,0),a=-Math.sin(G(o[2])),s=Math.sin(G(o[2]));if(3.6*e<40||0==t)return[0,i];const l=(a*n[0]+s*n[1])/r;return l>.9||l<0?[0,i]:[Math.floor(.25*D(Math.acos(l))*r)-i,i]},G=e=>e*(Math.PI/180),D=e=>e*(180/Math.PI);async function T(){await async function(){}(),await async function(){}(),await(a&&clearTick(a),void(a=setTick(async()=>{const e=PlayerPedId(),t=GetVehiclePedIsIn(e,!1);if(GetPedInVehicleSeat(t,-1)!==e)return await o(100);console.log("car YEP"),await o(100)}))),await void 0,await void 0,await void RegisterCommand("drift",(e,t)=>{if(0!==t.length)return"start"==t[0]?b():"end"==t[0]?P():void 0},!1)}const w=GetCurrentResourceName();on("onClientResourceStart",async e=>{e===w&&await T()})}]);